{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/gotoo/Documents/react-app/tango react node/tango/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/gotoo/Documents/react-app/tango react node/tango/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/gotoo/Documents/react-app/tango react node/tango/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import styled from'styled-components';import{Card,Section_num,Progress_bar,Word,Card_hidden,P1,P2,Button,Button_wrap,Showanswer,Show}from'./Quez_style';import Indicater from'../Indicater';import Rsult from'./Result';import{useParams,Link}from'react-router-dom';import axios from'axios';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Quez=function Quez(_ref){var status=_ref.status,setStatus=_ref.setStatus,recent=_ref.recent,setRecent=_ref.setRecent,tm=_ref.tm,settm=_ref.settm;var params=useParams();var section=params.sectionNum;var learn=params.learning;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),cardnum=_useState2[0],setCardnum=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),visible=_useState4[0],setVisible=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),words=_useState6[0],setWords=_useState6[1];var _useState7=useState('0'),_useState8=_slicedToArray(_useState7,2),total=_useState8[0],setTotal=_useState8[1];// total = words.length();\nvar fn=function fn(){setVisible(true);};var tmout;useEffect(function(){var f=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/tango/getquez/\".concat(section,\"/\").concat(learn));case 2:res=_context.sent;setWords(res.data);setTotal(res.data.length);// // check what kind of tango data should be loaded\n// const res = await axios.get(`/api/tango/status1/${section}`) \n// console.log(res.data.count)  \n// const count0=res.data.count0\n// const count2=res.data.count2\n// const count3=res.data.count3\n// if(learn==2){\n//   if(count0>0){\n//     if(count0<=20){\n// //  not to make remaining words 0 too few, so that quez won't end so early\n//       const res = await axios.get(`/api/tango/getquez/${section}/0/20`)\n//       setWords(res.data)\n//       setTotal(res.data.length)\n//       console.log(res.data, '00')\n//     }else{\n// //  get words of learning 0(not learned)\n//       const res = await axios.get(`/api/tango/getquez/${section}/0/15`)\n//       setWords(res.data)\n//       setTotal(res.data.length)\n//       console.log(res.data, '0')              \n//     }\n//   }else if(count0==0){\n// //  get words of learning 2,3(△or✕)\n//     const res = await axios.get(`/api/tango/getquez/${section}/2/15`)\n//     setWords(res.data)\n//     setTotal(res.data.length)\n//     console.log(res.data, '2')\n//   }else if(count2==0 && count3==0){\n//     const res = await axios.get(`/api/tango/getquez/${section}/1/15`)\n//     setWords(res.data)\n//     setTotal(res.data.length)\n//     console.log(res.data, '1')\n//   }\n// }else if(learn==3){\n//   const res = await axios.get(`/api/tango/getquez/${section}/3/15`)\n//   setWords(res.data)\n//   setTotal(res.data.length)\n//   console.log(res.data, '3')\n// }\ncase 5:case\"end\":return _context.stop();}}},_callee);}));return function f(){return _ref2.apply(this,arguments);};}();f();},[]);useEffect(function(){tmout=setTimeout(fn,tm);return function(){clearTimeout(tmout);};},[cardnum]);var show=function show(){setVisible(true);};var pushButton=function pushButton(id,learning,index){setCardnum(cardnum+1);setVisible(false);addAnswer(id,learning);// check if quez is ended\nif(index+1===total){result();}};// register words's learning level (1 or 2 or 0)\nvar addAnswer=function addAnswer(id,learning){axios.post(\"/api/tango/answer\",{id:id,learning:learning});};// get the overall result of section(learning level and progress)and register that to database\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),resultNum=_useState10[0],setResult=_useState10[1];var result=function result(){axios.get(\"/api/tango/result/\".concat(section)).then(function(response){setResult(response.data);setRecent(response.data);});axios.post(\"/api/tango/markUpdate/\".concat(section));// setRecent({'section':section},{'answerrate':})\n};return/*#__PURE__*/_jsxs(\"div\",{children:[words.map(function(word,index){return/*#__PURE__*/_jsxs(Card,{value:word.learning,num:index,cardnum:cardnum,children:[/*#__PURE__*/_jsxs(Section_num,{children:[\"Section\",word.section]}),/*#__PURE__*/_jsx(Progress_bar,{children:/*#__PURE__*/_jsx(Indicater,{bar_wrap_color:\"true\",bar_color:\"#FF7171\",percentage:(index+1)*100/(total+1)})}),/*#__PURE__*/_jsx(Word,{children:/*#__PURE__*/_jsx(\"p\",{children:word.korean})}),/*#__PURE__*/_jsxs(Card_hidden,{vis:visible,children:[/*#__PURE__*/_jsx(P1,{children:word.meaning}),/*#__PURE__*/_jsx(P2,{children:word.pronounce})]}),/*#__PURE__*/_jsxs(Button_wrap,{children:[/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return pushButton(word.id,'1',index);},color:\"#87d3ff\",children:\"\\u3007\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return pushButton(word.id,'2',index);},color:\"#ffe100\",children:\"\\u25B3\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return pushButton(word.id,'3',index);},color:\"#ff9a8f\",children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(Showanswer,{onClick:show,children:/*#__PURE__*/_jsx(Show,{children:\"\\u7B54\\u3048\\u3092\\u898B\\u308B\"})})]},index);}),/*#__PURE__*/_jsx(Card,{num:total,cardnum:cardnum,children:/*#__PURE__*/_jsx(Rsult,{result:resultNum})}),/*#__PURE__*/_jsxs(Card,{style:{'zIndex':'1','display':'flex'},children:[\"loading\",/*#__PURE__*/_jsx(\"p\",{children:\".\"}),/*#__PURE__*/_jsx(\"p\",{children:\".\"}),\".\"]})]});};export default Quez;","map":{"version":3,"names":["React","useEffect","useState","styled","Card","Section_num","Progress_bar","Word","Card_hidden","P1","P2","Button","Button_wrap","Showanswer","Show","Indicater","Rsult","useParams","Link","axios","Quez","status","setStatus","recent","setRecent","tm","settm","params","section","sectionNum","learn","learning","cardnum","setCardnum","visible","setVisible","words","setWords","total","setTotal","fn","tmout","f","get","res","data","length","setTimeout","clearTimeout","show","pushButton","id","index","addAnswer","result","post","resultNum","setResult","then","response","map","word","korean","meaning","pronounce"],"sources":["C:/Users/gotoo/Documents/react-app/tango react node/tango/src/Components/Quez/Quez.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport {Card,Section_num,Progress_bar,Word,Card_hidden,P1,P2,Button,Button_wrap,Showanswer,Show} from './Quez_style'\nimport Indicater from '../Indicater'\nimport Rsult from './Result'\nimport { useParams, Link } from 'react-router-dom'\nimport axios from 'axios';\n\nconst Quez = ({ status, setStatus, recent, setRecent, tm, settm }) => {\n  let params = useParams();\n  const section = params.sectionNum;\n  const learn = params.learning;\n\n  const [cardnum, setCardnum] = useState(0)\n  const [visible, setVisible] = useState(false)\n  const [words, setWords] = useState([\n  ]) \n  const [total, setTotal] = useState('0')\n  \n  // total = words.length();\n  \n  var fn = () => {\n    setVisible(true)\n    }\n  var tmout; \n\n  useEffect(() => {\n    const f = async () => {\n      const res = await axios.get(`/api/tango/getquez/${section}/${learn}`)\n      setWords(res.data)\n      setTotal(res.data.length)\n      // // check what kind of tango data should be loaded\n      // const res = await axios.get(`/api/tango/status1/${section}`) \n      // console.log(res.data.count)  \n      // const count0=res.data.count0\n      // const count2=res.data.count2\n      // const count3=res.data.count3\n      // if(learn==2){\n      //   if(count0>0){\n      //     if(count0<=20){\n      // //  not to make remaining words 0 too few, so that quez won't end so early\n      //       const res = await axios.get(`/api/tango/getquez/${section}/0/20`)\n      //       setWords(res.data)\n      //       setTotal(res.data.length)\n      //       console.log(res.data, '00')\n      //     }else{\n      // //  get words of learning 0(not learned)\n      //       const res = await axios.get(`/api/tango/getquez/${section}/0/15`)\n      //       setWords(res.data)\n      //       setTotal(res.data.length)\n      //       console.log(res.data, '0')              \n      //     }\n      //   }else if(count0==0){\n      // //  get words of learning 2,3(△or✕)\n      //     const res = await axios.get(`/api/tango/getquez/${section}/2/15`)\n      //     setWords(res.data)\n      //     setTotal(res.data.length)\n      //     console.log(res.data, '2')\n      //   }else if(count2==0 && count3==0){\n      //     const res = await axios.get(`/api/tango/getquez/${section}/1/15`)\n      //     setWords(res.data)\n      //     setTotal(res.data.length)\n      //     console.log(res.data, '1')\n      //   }\n      // }else if(learn==3){\n      //   const res = await axios.get(`/api/tango/getquez/${section}/3/15`)\n      //   setWords(res.data)\n      //   setTotal(res.data.length)\n      //   console.log(res.data, '3')\n      // }\n    }\n    f()\n  },[])\n  \n  useEffect(()=>{\n    tmout = setTimeout(fn, tm);\n    return ()=>{clearTimeout(tmout)}\n  },[cardnum])\n\n  const show = () => {\n    setVisible(true)\n  }\n \n  const pushButton = (id, learning, index) => {\n    setCardnum(cardnum+1);\n    setVisible(false);\n    addAnswer(id, learning);\n    // check if quez is ended\n    if(index+1===total){\n      result()\n    }\n  }\n\n  // register words's learning level (1 or 2 or 0)\n  const addAnswer = (id, learning) => {\n    axios.post(`/api/tango/answer`,{\n      id,\n      learning,\n    })\n  }\n\n  // get the overall result of section(learning level and progress)and register that to database\n  const [resultNum, setResult] = useState()\n  const result = () => {\n    axios.get(`/api/tango/result/${section}`)\n      .then((response) => {\n        setResult(response.data)\n        setRecent(response.data)\n      })\n    axios.post(`/api/tango/markUpdate/${section}`)\n    // setRecent({'section':section},{'answerrate':})\n  }\n\n  return (\n    <div >\n      {/* <Indicater styled={{'marginTop':'100px'}} bar_color='pink' percentage='100%'></Indicater> */}\n      \n      {words.map((word, index) => ( \n      <Card key={index} value={word.learning} num={index} cardnum={cardnum}>\n        <Section_num>Section{word.section}</Section_num>\n        <Progress_bar><Indicater \n          bar_wrap_color='true'\n          bar_color='#FF7171' \n          percentage={(index+1)*100/(total+1)} \n        /></Progress_bar>\n        <Word><p>{word.korean}</p></Word>\n        <Card_hidden vis={visible}>\n          <P1>{word.meaning}</P1>\n          <P2>{word.pronounce}</P2>\n        \n        </Card_hidden>\n        <Button_wrap>\n          <Button onClick={() => pushButton(word.id, '1', index)} color='#87d3ff'>〇</Button>\n          <Button onClick={() => pushButton(word.id, '2', index)} color='#ffe100'>△</Button>\n          <Button onClick={() => pushButton(word.id, '3', index)} color='#ff9a8f'>✕</Button>\n        </Button_wrap>\n        \n        <Showanswer onClick={show}><Show>答えを見る</Show></Showanswer>\n      </Card>\n      ))}\n      <Card num={total} cardnum={cardnum}>\n        <Rsult result={resultNum}/>\n      </Card>\n      <Card style={{'zIndex': '1', 'display':'flex'}}>loading<p>.</p><p>.</p>.</Card>\n      \n    </div>\n  )\n}\n\nexport default Quez\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}